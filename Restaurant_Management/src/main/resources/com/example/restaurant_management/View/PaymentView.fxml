<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.image.ImageView?>

<BorderPane xmlns="http://javafx.com/javafx/24"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.restaurant_management.Controller.PaymentController"
            prefWidth="800" prefHeight="700">
    <top>
        <VBox alignment="CENTER" spacing="10" style="-fx-background-color: #f8f8f8; -fx-border-color: #e0e0e0; -fx-border-width: 0 0 1 0;">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <Label fx:id="lblTableInfo" text="HÓA ĐƠN THANH TOÁN"
                   style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
            <Label fx:id="lblInvoiceNumber" text="Số hóa đơn: -"
                   style="-fx-font-size: 14px; -fx-text-fill: #666;"/>
        </VBox>
    </top>

    <center>
        <SplitPane dividerPositions="0.5" style="-fx-background-color: #ffffff;">
            <!-- Left side: Order details -->
            <ScrollPane fitToWidth="true" style="-fx-background-color: #ffffff;">
                <VBox fx:id="invoiceDetailsContainer" spacing="10" style="-fx-background-color: #ffffff;">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>
                    
                    <Label text="CHI TIẾT ĐƠN HÀNG" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>
                    
                    <!-- Header row -->
                    <HBox spacing="10" style="-fx-background-color: #f0f0f0; -fx-padding: 10;">
                        <Label text="Tên món" style="-fx-font-weight: bold; -fx-pref-width: 200;"/>
                        <Label text="Số lượng" style="-fx-font-weight: bold; -fx-pref-width: 80; -fx-alignment: center;"/>
                        <Label text="Đơn giá" style="-fx-font-weight: bold; -fx-pref-width: 120; -fx-alignment: center-right;"/>
                        <Label text="Thành tiền" style="-fx-font-weight: bold; -fx-pref-width: 120; -fx-alignment: center-right;"/>
                    </HBox>
                    
                    <Separator/>
                    
                    <!-- Order items will be added here dynamically -->
                </VBox>
            </ScrollPane>
            
            <!-- Right side: Add more items -->
            <VBox spacing="15" style="-fx-background-color: #f8f8f8; -fx-padding: 20;">
                <Label text="GỌI THÊM MÓN" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>
                
                <ScrollPane fitToWidth="true" prefHeight="400" style="-fx-background-color: transparent;">
                    <FlowPane fx:id="menuContainer" hgap="10" vgap="10" style="-fx-background-color: transparent;"/>
                </ScrollPane>
                
                <Separator/>
                
                <VBox fx:id="selectedItemsContainer" spacing="8" visible="false" managed="false">
                    <Label text="Món đã chọn:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                    <VBox fx:id="selectedItemsList" spacing="5"/>
                </VBox>
                
                <HBox alignment="CENTER_RIGHT" spacing="10">
                    <Button text="Thêm món" fx:id="btnAddItems" 
                            style="-fx-background-color: #27AE60; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10 20; -fx-background-radius: 8; -fx-font-weight: bold;"
                            onAction="#handleAddItems"/>
                    <Button text="Hủy" fx:id="btnCancelAdd" 
                            style="-fx-background-color: #95A5A6; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10 20; -fx-background-radius: 8;"
                            onAction="#handleCancelAddItems"/>
                </HBox>
            </VBox>
        </SplitPane>
    </center>

    <bottom>
        <VBox spacing="15" style="-fx-background-color: #f8f8f8; -fx-border-color: #e0e0e0; -fx-border-width: 1 0 0 0;">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            
            <!-- Total amount -->
            <HBox alignment="CENTER_RIGHT" spacing="20">
                <Label text="TỔNG CỘNG:" style="-fx-font-size: 20px; -fx-font-weight: bold;"/>
                <Label fx:id="lblTotalAmount" text="0 VND" 
                       style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #E67E22;"/>
            </HBox>
            
            <Separator/>
            
            <!-- Payment method selection (initially hidden) -->
            <VBox fx:id="paymentMethodContainer" spacing="10" visible="false" managed="false">
                <Label text="Chọn phương thức thanh toán:" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                <HBox spacing="20" alignment="CENTER">
                    <Button text="Tiền mặt" fx:id="btnCash" 
                            style="-fx-background-color: #43A047; -fx-text-fill: white; -fx-font-size: 16px; -fx-padding: 15 30; -fx-background-radius: 8; -fx-font-weight: bold;"
                            onAction="#handleCashPayment"/>
                    <Button text="Chuyển khoản" fx:id="btnBankTransfer"
                            style="-fx-background-color: #0288D1; -fx-text-fill: white; -fx-font-size: 16px; -fx-padding: 15 30; -fx-background-radius: 8; -fx-font-weight: bold;"
                            onAction="#handleBankTransferPayment"/>
                </HBox>
            </VBox>
            
            <!-- QR Code display (initially hidden) -->
            <VBox fx:id="qrCodeContainer" spacing="10" visible="false" managed="false" alignment="CENTER">
                <Label text="Quét mã QR để thanh toán:" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                <ImageView fx:id="qrCodeImage" fitWidth="250" fitHeight="250" preserveRatio="true"/>
                <Button text="Đã thanh toán" fx:id="btnConfirmPayment"
                        style="-fx-background-color: #27AE60; -fx-text-fill: white; -fx-font-size: 16px; -fx-padding: 10 20; -fx-background-radius: 8; -fx-font-weight: bold;"
                        onAction="#handleConfirmPayment"/>
            </VBox>
            
            <!-- Pay button (main action) -->
            <HBox alignment="CENTER" spacing="20">
                <Button text="Thanh toán" fx:id="btnPay"
                        style="-fx-background-color: #E67E22; -fx-text-fill: white; -fx-font-size: 18px; -fx-padding: 15 40; -fx-background-radius: 8; -fx-font-weight: bold;"
                        onAction="#handlePayButton"/>
                <Button text="Đóng" fx:id="btnClose"
                        style="-fx-background-color: #95A5A6; -fx-text-fill: white; -fx-font-size: 16px; -fx-padding: 10 30; -fx-background-radius: 8;"
                        onAction="#handleClose"/>
            </HBox>
        </VBox>
    </bottom>
</BorderPane>

